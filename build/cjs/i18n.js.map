{
  "version": 3,
  "sources": ["../esm/i18n.js"],
  "sourcesContent": ["import { readFileSync, readdirSync, existsSync, statSync } from \"node:fs\";\nimport { join } from \"node:path\";\nlet language = \"en\";\nlet words = null;\n// Init internationalization\nexport async function init(\n/** The root directory of the adapter */\nrootDir, \n/** The adapter instance or the language to use */\nlanguageOrAdapter) {\n    let adapter;\n    if (languageOrAdapter && typeof languageOrAdapter === \"object\") {\n        adapter = languageOrAdapter;\n        const systemConfig = await adapter.getForeignObjectAsync(\"system.config\");\n        if (systemConfig?.common.language) {\n            language = systemConfig?.common.language;\n        }\n    }\n    else if (typeof languageOrAdapter === \"string\") {\n        language = languageOrAdapter;\n    }\n    let files;\n    if (existsSync(join(rootDir, \"i18n\"))) {\n        files = readdirSync(join(rootDir, \"i18n\"));\n    }\n    else if (existsSync(join(rootDir, \"lib\", \"i18n\"))) {\n        rootDir = join(rootDir, \"lib\");\n        files = readdirSync(join(rootDir, \"i18n\"));\n    }\n    else {\n        throw new Error(\"Cannot find i18n directory\");\n    }\n    words = {};\n    let count = 0;\n    files.forEach((file) => {\n        if (file.endsWith(\".json\")) {\n            count++;\n            const lang = file.split(\".\")[0];\n            const wordsForLanguage = JSON.parse(readFileSync(join(rootDir, \"i18n\", file)).toString(\"utf8\"));\n            Object.keys(wordsForLanguage).forEach((key) => {\n                if (words) {\n                    if (!words[key]) {\n                        words[key] = {};\n                    }\n                    words[key][lang] = wordsForLanguage[key];\n                }\n            });\n        }\n    });\n    if (!count) {\n        // may be it is an old structure: i18n/lang/translation.json\n        files.forEach((file) => {\n            if ((file.match(/^[a-z]{2}$/) || file === \"zh-cn\") &&\n                statSync(join(rootDir, \"i18n\", file)).isDirectory()) {\n                if (adapter) {\n                    adapter.log.warn(\"Looks like you use old structure of i18n. \" +\n                        \"Please switch to 1i8n/lang.json instead of i18n/lang/translation.json\");\n                }\n                const lang = file;\n                if (existsSync(join(rootDir, \"i18n\", lang, \"translations.json\"))) {\n                    const wordsForLanguage = JSON.parse(readFileSync(join(rootDir, \"i18n\", lang, \"translations.json\")).toString(\"utf8\"));\n                    Object.keys(wordsForLanguage).forEach((key) => {\n                        if (words) {\n                            if (!words[key]) {\n                                words[key] = {};\n                            }\n                            words[key][lang] = wordsForLanguage[key];\n                        }\n                    });\n                }\n            }\n        });\n    }\n}\n/**\n * Get translation as one string\n */\nexport function t(\n/** Word to translate */\nkey, \n/** Optional parameters to replace %s */\n...args) {\n    if (!words) {\n        throw new Error(\"i18n not initialized. Please call 'init(__dirname, adapter)' before\");\n    }\n    if (!words[key]) {\n        return key;\n    }\n    let text = words[key][language] || words[key].en || key;\n    if (args.length) {\n        for (let i = 0; i < args.length; i++) {\n            text = text.replace(\"%s\", \n            // @ts-expect-error No idea why args[i] is not accepted here\n            args[i] === null ? \"null\" : args[i].toString());\n        }\n    }\n    return text;\n}\n/**\n * Get translation as ioBroker.Translated object\n */\nexport function tt(\n/** Word to translate */\nkey, \n/** Optional parameters to replace %s */\n...args) {\n    if (!words) {\n        throw new Error(\"i18n not initialized. Please call 'init(__dirname, adapter)' before\");\n    }\n    if (words[key]) {\n        if (words[key].en && words[key].en.includes(\"%s\")) {\n            const result = {};\n            Object.keys(words[key]).forEach((lang) => {\n                for (let i = 0; i < args.length; i++) {\n                    result[lang] =\n                        // @ts-expect-error words[key] cannot be null\n                        words[key][lang].replace(\"%s\", \n                        // @ts-expect-error No idea why args[i] is not accepted here\n                        args[i] === null ? \"null\" : args[i].toString());\n                }\n            });\n            return result;\n        }\n        return words[key];\n    }\n    return key;\n}\n"],
  "mappings": "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",
  "names": []
}
